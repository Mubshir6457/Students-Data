<!DOCTYPE html>
<html lang="ur">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø¯Ø±Ø³Û Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹ Ø³Ø³Ù¹Ù…</title>
<style>
body{font-family:Arial;direction:rtl;margin:0;padding:20px;background:#f0f2f5}
.container{max-width:1000px;margin:auto;background:white;border-radius:15px;box-shadow:0 5px 20px rgba(0,0,0,0.1);overflow:hidden}
.header{background:linear-gradient(135deg,#1a5f7a,#1597bb);color:white;padding:20px;text-align:center}
.header h1{margin:0;font-size:24px}
.header p{margin:5px 0 0;opacity:0.9}
.content{padding:20px}
.box{background:#f8f9fa;border-radius:10px;padding:20px;margin-bottom:20px;border:1px solid #e0e0e0}
.box-title{color:#1a5f7a;font-size:18px;margin:0 0 15px 0;padding-bottom:8px;border-bottom:2px solid #17a2b8}
.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px}
.form-group{margin-bottom:12px}
label{display:block;margin-bottom:6px;color:#495057;font-weight:500;font-size:13px}
input,select,textarea{width:100%;padding:10px;border:1px solid #dee2e6;border-radius:6px;font-size:13px}
input:focus,select:focus,textarea:focus{outline:none;border-color:#17a2b8}
.btn{padding:10px 20px;border:none;border-radius:6px;font-size:14px;cursor:pointer;transition:0.3s;margin:5px}
.btn-search{background:#28a745;color:white}
.btn-search:hover{background:#218838}
.btn-submit{background:#007bff;color:white}
.btn-submit:hover{background:#0056b3}
.btn-delete{background:#dc3545;color:white}
.btn-delete:hover{background:#c82333}
.btn-logout{background:#6c757d;color:white}
.btn-logout:hover{background:#545b62}
.btn-excel{background:#20c997;color:white}
.btn-excel:hover{background:#17a589}
.search-results{background:white;border-radius:8px;padding:15px;margin-top:15px;border:1px solid #dee2e6}
.student-card{background:#f8f9fa;border-radius:8px;padding:15px;margin-bottom:10px;border-left:4px solid #17a2b8}
.kharaj-card{border-left-color:#dc3545;background:#fff3cd}
.student-info{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-top:10px}
.info-item{background:white;padding:8px;border-radius:5px;border:1px solid #eee}
.info-label{font-size:11px;color:#6c757d;margin-bottom:2px}
.info-value{font-weight:500;color:#212529;font-size:13px}
.login-box{max-width:350px;margin:40px auto;padding:25px;background:white;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
.hidden{display:none}
.status-badge{padding:3px 10px;border-radius:12px;font-size:11px;font-weight:500;display:inline-block}
.active-badge{background:#d4edda;color:#155724}
.kharaj-badge{background:#f8d7da;color:#721c24}
.stats-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px}
.stat-box{padding:15px;border-radius:8px;color:white;text-align:center}
.stat-box.total{background:#1a5f7a}
.stat-box.active{background:#28a745}
.stat-box.outside{background:#dc3545}
.stat-box.tution{background:#ffc107;color:#212529}
.stat-box.separa{background:#17a2b8}
.stat-number{font-size:28px;font-weight:bold;margin:5px 0}
.stat-label{font-size:14px}
.clear-search{background:#6c757d;color:white;border:none;padding:8px 15px;border-radius:4px;font-size:12px;cursor:pointer;margin-left:10px}
.category-badge{padding:2px 8px;border-radius:10px;font-size:10px;margin-left:5px}
.category-tution{background:#ffc107;color:#212529}
.category-separa{background:#17a2b8;color:white}
</style>
<!-- SheetJS for Excel -->
<script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
<div class="header">
<h1>ğŸ“š Ù…Ø¯Ø±Ø³Û Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹ Ø³Ø³Ù¹Ù…</h1>
<p>Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù…ÙˆÚº Ú©ÛŒ Ø§Ù†Ø¯Ø±Ø§Ø¬ Ø§ÙˆØ± Ø§Ù†ØªØ¸Ø§Ù…</p>
</div>

<div class="content">
<!-- Ø³Ø±Ú† Ø³ÛŒÚ©Ø´Ù† -->
<div class="box">
<div class="box-title">ğŸ” Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº</div>
<div class="form-grid">
<div class="form-group">
<label>Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº</label>
<input type="text" id="searchRoll" placeholder="Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº">
</div>
<div class="form-group">
<label>ÛŒØ§ Ù†Ø§Ù… Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº</label>
<input type="text" id="searchName" placeholder="Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù…">
</div>
</div>
<button class="btn btn-search" onclick="searchStudent()">ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº</button>
<button class="clear-search" onclick="clearSearch()">ØªÙ„Ø§Ø´ ØµØ§Ù Ú©Ø±ÛŒÚº</button>
<div id="searchResults" class="search-results hidden">
<h3 style="margin-top:0;color:#1a5f7a">ØªÙ„Ø§Ø´ Ú©Û’ Ù†ØªØ§Ø¦Ø¬:</h3>
<div id="searchResultsContent"></div>
</div>
</div>

<!-- Ù„Ø§Ú¯ Ø§Ù† Ø³ÛŒÚ©Ø´Ù† -->
<div class="login-box" id="loginBox">
<h2 style="text-align:center;color:#1a5f7a;margin-bottom:20px">ğŸ” Ø§ÛŒÚˆÙ…Ù† Ù„Ø§Ú¯ Ø§Ù†</h2>
<div class="form-group">
<label>Ø§ÛŒ Ù…ÛŒÙ„</label>
<input type="email" id="email" placeholder="admin@example.com" value="admin@example.com">
</div>
<div class="form-group">
<label>Ù¾Ø§Ø³ ÙˆØ±Úˆ</label>
<input type="password" id="password" placeholder="Ù¾Ø§Ø³ ÙˆØ±Úˆ" value="admin123">
</div>
<button class="btn btn-submit" style="width:100%;margin-top:15px" onclick="login()">Ù„Ø§Ú¯ Ø§Ù† Ú©Ø±ÛŒÚº</button>
</div>

<!-- Ø§ÛŒÚˆÙ…Ù† Ù¾ÛŒÙ†Ù„ -->
<div id="adminPanel" class="hidden">
<!-- Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="stats-container" id="statsContainer"></div>

<!-- Ø§ÛŒÚ©Ø³Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ -->
<div class="box">
<div class="box-title">ğŸ“Š ÚˆÛŒÙ¹Ø§ Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹</div>
<button class="btn btn-excel" onclick="exportToExcel()">ğŸ“¥ Ø§ÛŒÚ©Ø³Ù„ ÙØ§Ø¦Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>
<p style="color:#666;font-size:12px;margin-top:10px">Ø§ÛŒÚ© ÙØ§Ø¦Ù„ Ù…ÛŒÚº 5 Ø´ÛŒÙ¹Ø³ ÛÙˆÚº Ú¯ÛŒ: ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ØŒ ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡ØŒ Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ØŒ ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³ØŒ Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³</p>
</div>

<!-- Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ Ù„Ø³Ù¹ Ø¨Ø§Ú©Ø³Ø² -->
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:15px;margin-bottom:20px">
<div class="box">
<div class="box-title">ğŸ‘¨â€ğŸ“ ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡</div>
<div id="activeStudentsList" class="students-list" style="max-height:300px;overflow-y:auto"></div>
</div>
<div class="box">
<div class="box-title">ğŸšª Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡</div>
<div id="outsideStudentsList" class="students-list" style="max-height:300px;overflow-y:auto"></div>
</div>
</div>

<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:15px;margin-bottom:20px">
<div class="box">
<div class="box-title">ğŸ“– ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³</div>
<div id="tutionStudentsList" class="students-list" style="max-height:300px;overflow-y:auto"></div>
</div>
<div class="box">
<div class="box-title">ğŸ“š Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³</div>
<div id="separaStudentsList" class="students-list" style="max-height:300px;overflow-y:auto"></div>
</div>
</div>

<!-- Ø§Ù†Ø¯Ø±Ø§Ø¬ ÙØ§Ø±Ù… -->
<div class="box">
<div class="box-title">â• Ù†Ø¦ÛŒ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø§Ù†Ø¯Ø±Ø§Ø¬</div>
<div class="form-grid">
<div class="form-group">
<label>Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± *</label>
<input type="text" id="rollNo" required>
</div>
<div class="form-group">
<label>Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù… *</label>
<input type="text" id="name" required>
</div>
<div class="form-group">
<label>ÙˆØ§Ù„Ø¯ Ú©Ø§ Ù†Ø§Ù…</label>
<input type="text" id="fatherName">
</div>
<div class="form-group">
<label>Ø¹Ù…Ø±</label>
<input type="number" id="age">
</div>
</div>
<div class="form-grid">
<div class="form-group">
<label>Ú©Ù„Ø§Ø³ (Ø§ÛŒÚˆÙ…Ù† Ù„Ú©Ú¾Û’) *</label>
<input type="text" id="class" placeholder="Ù…Ø«Ø§Ù„: Ù†ÙˆØ±Ø§Ù†ÛŒ Ù‚Ø§Ø¹Ø¯ÛØŒ Ø­ÙØ¸ Ù‚Ø±Ø¢Ù†" required>
</div>
<div class="form-group">
<label>Ú©Ù„Ø§Ø³ Ú©ÛŒ Ù‚Ø³Ù… *</label>
<select id="classType" required>
<option value="">Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</option>
<option value="ØªÛŒÙˆØ´Ù†">ØªÛŒÙˆØ´Ù†</option>
<option value="Ø³Ù¾Ø§Ø±Û">Ø³Ù¾Ø§Ø±Û</option>
</select>
</div>
<div class="form-group">
<label>Ø³Ù„Ø³Ù„Û Ù†Ù…Ø¨Ø±</label>
<input type="text" id="serialNo">
</div>
</div>
<div class="form-grid">
<div class="form-group">
<label>ØªØ§Ø±ÛŒØ® Ø§Ù†Ø¯Ø±Ø§Ø¬ *</label>
<input type="date" id="admissionDate" required>
</div>
</div>
<button class="btn btn-submit" onclick="addStudent()">âœ… Ø§Ù†Ø¯Ø±Ø§Ø¬ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
</div>

<!-- Ø®Ø§Ø±Ø¬ Ú©Ø±Ù†Û’ Ú©Ø§ ÙØ§Ø±Ù… -->
<div class="box">
<div class="box-title">ğŸšª Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø®Ø§Ø±Ø¬ Ú©Ø±ÛŒÚº</div>
<div class="form-grid">
<div class="form-group">
<label>Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± *</label>
<input type="text" id="kharajRoll" required>
</div>
<div class="form-group">
<label>Ø®Ø§Ø±Ø¬ ÛÙˆÙ†Û’ Ú©ÛŒ ØªØ§Ø±ÛŒØ® *</label>
<input type="date" id="kharajDate" required>
</div>
</div>
<div class="form-grid">
<div class="form-group">
<label>Ø®Ø§Ø±Ø¬ ÛÙˆÙ†Û’ Ú©ÛŒ ÙˆØ¬Û *</label>
<select id="kharajReason" required>
<option value="">Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</option>
<option value="Ú©ÙˆØ±Ø³ Ù…Ú©Ù…Ù„">Ú©ÙˆØ±Ø³ Ù…Ú©Ù…Ù„</option>
<option value="Ø®Ø§Ù†Ø¯Ø§Ù†ÛŒ ÙˆØ¬ÙˆÛØ§Øª">Ø®Ø§Ù†Ø¯Ø§Ù†ÛŒ ÙˆØ¬ÙˆÛØ§Øª</option>
<option value="Ù…Ø¯Ø±Ø³Û ØªØ¨Ø¯ÛŒÙ„">Ù…Ø¯Ø±Ø³Û ØªØ¨Ø¯ÛŒÙ„</option>
<option value="Ø¹Ù„Ø§Ù„Øª">Ø¹Ù„Ø§Ù„Øª</option>
<option value="ÛØ¬Ø±Øª">ÛØ¬Ø±Øª</option>
<option value="Ø¯ÛŒÚ¯Ø±">Ø¯ÛŒÚ¯Ø±</option>
</select>
</div>
<div class="form-group">
<label>Ù…Ø¯Øª Ù‚ÛŒØ§Ù… (Ù…ÛÛŒÙ†ÙˆÚº Ù…ÛŒÚº)</label>
<input type="number" id="duration" placeholder="Ù…Ø¯Ø±Ø³Û Ù…ÛŒÚº Ø±ÛÙ†Û’ Ú©ÛŒ Ù…Ø¯Øª">
</div>
</div>
<button class="btn btn-delete" onclick="markKharaj()">ğŸšª Ø®Ø§Ø±Ø¬ Ú©Ø±ÛŒÚº</button>
</div>

<!-- Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ ÚˆÛŒÙ„ÛŒÙ¹ -->
<div class="box">
<div class="box-title">ğŸ—‘ï¸ Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… ÚˆÛŒÙ„ÛŒÙ¹ Ú©Ø±ÛŒÚº</div>
<div class="form-grid">
<div class="form-group">
<label>Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº</label>
<input type="text" id="deleteRoll" placeholder="Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±">
</div>
</div>
<button class="btn btn-delete" onclick="deleteKharajStudent()">Ù…Ú©Ù…Ù„ ÚˆÛŒÙ¹Ø§ ÚˆÛŒÙ„ÛŒÙ¹ Ú©Ø±ÛŒÚº</button>
<p style="color:#666;font-size:12px;margin-top:10px">Ù†ÙˆÙ¹: ØµØ±Ù Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ Ú©Ø§ ÚˆÛŒÙ¹Ø§ ÚˆÛŒÙ„ÛŒÙ¹ ÛÙˆØ³Ú©ØªØ§ ÛÛ’</p>
</div>

<!-- Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ -->
<div style="text-align:center;margin-top:20px;padding-top:15px;border-top:1px solid #eee">
<button class="btn btn-logout" onclick="logout()">ğŸšª Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ú©Ø±ÛŒÚº</button>
</div>
</div>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getDatabase, ref, set, get, update, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAlXd1v5IZwaEROAdfKMXMUPflIorWV4Zg",
  authDomain: "students-51da1.firebaseapp.com",
  databaseURL: "https://students-51da1-default-rtdb.firebaseio.com",
  projectId: "students-51da1",
  storageBucket: "students-51da1.firebasestorage.app",
  messagingSenderId: "785878911811",
  appId: "1:785878911811:web:5a0a480d3ceca57976bdf6"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// Authentication Functions
window.login = async () => {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  
  if (!email || !password) {
    alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø§ÛŒ Ù…ÛŒÙ„ Ø§ÙˆØ± Ù¾Ø§Ø³ ÙˆØ±Úˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
    return;
  }
  
  try {
    await signInWithEmailAndPassword(auth, email, password);
    alert('âœ… Ù„Ø§Ú¯ Ø§Ù† Ú©Ø§Ù…ÛŒØ§Ø¨!');
  } catch (error) {
    alert('âŒ Ù„Ø§Ú¯ Ø§Ù† Ù†Ø§Ú©Ø§Ù…: ' + error.message);
  }
};

onAuthStateChanged(auth, (user) => {
  if (user) {
    document.getElementById('loginBox').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
    loadAllStudents();
    updateStats();
  } else {
    document.getElementById('loginBox').classList.remove('hidden');
    document.getElementById('adminPanel').classList.add('hidden');
  }
});

window.logout = async () => {
  try {
    await signOut(auth);
    alert('âœ… Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ú©Ø§Ù…ÛŒØ§Ø¨!');
  } catch (error) {
    alert('âŒ Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ');
  }
};

// Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
async function updateStats() {
  try {
    const snapshot = await get(ref(db, 'students'));
    
    if (!snapshot.exists()) {
      document.getElementById('statsContainer').innerHTML = `
        <div class="stat-box total">
          <div class="stat-number">0</div>
          <div class="stat-label">Ú©Ù„ Ø·Ù„Ø¨Ø§Ø¡</div>
        </div>
        <div class="stat-box active">
          <div class="stat-number">0</div>
          <div class="stat-label">ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡</div>
        </div>
        <div class="stat-box outside">
          <div class="stat-number">0</div>
          <div class="stat-label">Ø®Ø§Ø±Ø¬ Ø´Ø¯Û</div>
        </div>
        <div class="stat-box tution">
          <div class="stat-number">0</div>
          <div class="stat-label">ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³</div>
        </div>
        <div class="stat-box separa">
          <div class="stat-number">0</div>
          <div class="stat-label">Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³</div>
        </div>
      `;
      return;
    }
    
    const students = snapshot.val();
    let total = 0;
    let active = 0;
    let outside = 0;
    let tution = 0;
    let separa = 0;
    
    for (const student of Object.values(students)) {
      total++;
      if (student.status === 'active') {
        active++;
      } else {
        outside++;
      }
      if (student.classType === 'ØªÛŒÙˆØ´Ù†') {
        tution++;
      } else if (student.classType === 'Ø³Ù¾Ø§Ø±Û') {
        separa++;
      }
    }
    
    document.getElementById('statsContainer').innerHTML = `
      <div class="stat-box total">
        <div class="stat-number">${total}</div>
        <div class="stat-label">Ú©Ù„ Ø·Ù„Ø¨Ø§Ø¡</div>
      </div>
      <div class="stat-box active">
        <div class="stat-number">${active}</div>
        <div class="stat-label">ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡</div>
      </div>
      <div class="stat-box outside">
        <div class="stat-number">${outside}</div>
        <div class="stat-label">Ø®Ø§Ø±Ø¬ Ø´Ø¯Û</div>
      </div>
      <div class="stat-box tution">
        <div class="stat-number">${tution}</div>
        <div class="stat-label">ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³</div>
      </div>
      <div class="stat-box separa">
        <div class="stat-number">${separa}</div>
        <div class="stat-label">Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³</div>
      </div>
    `;
  } catch (error) {
    console.error('Error updating stats:', error);
  }
}

// Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº (Ø±ÙˆÙ„ ÛŒØ§ Ù†Ø§Ù… Ø³Û’)
window.searchStudent = async () => {
  const roll = document.getElementById('searchRoll').value.trim();
  const name = document.getElementById('searchName').value.trim();
  
  if (!roll && !name) {
    alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± ÛŒØ§ Ù†Ø§Ù… Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
    return;
  }
  
  try {
    const studentsRef = ref(db, 'students');
    const snapshot = await get(studentsRef);
    const resultsDiv = document.getElementById('searchResults');
    const resultsContent = document.getElementById('searchResultsContent');
    
    resultsContent.innerHTML = '';
    resultsDiv.classList.add('hidden');
    
    if (!snapshot.exists()) {
      resultsContent.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº</div>';
      resultsDiv.classList.remove('hidden');
      return;
    }
    
    const students = snapshot.val();
    let found = false;
    
    for (const [rollNo, student] of Object.entries(students)) {
      const matchRoll = roll && rollNo.includes(roll);
      const matchName = name && student.name && student.name.toLowerCase().includes(name.toLowerCase());
      
      if (matchRoll || matchName) {
        displayStudentCard(resultsContent, rollNo, student);
        found = true;
      }
    }
    
    if (!found) {
      resultsContent.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº Ù…Ù„Ø§</div>';
    }
    
    resultsDiv.classList.remove('hidden');
  } catch (error) {
    alert('ØªÙ„Ø§Ø´ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
  }
};

// ØªÙ„Ø§Ø´ ØµØ§Ù Ú©Ø±ÛŒÚº
window.clearSearch = () => {
  document.getElementById('searchRoll').value = '';
  document.getElementById('searchName').value = '';
  document.getElementById('searchResults').classList.add('hidden');
  document.getElementById('searchResultsContent').innerHTML = '';
};

// Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§Ø±Úˆ Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
function displayStudentCard(container, rollNo, student) {
  const card = document.createElement('div');
  card.className = `student-card ${student.status === 'kharaj' ? 'kharaj-card' : ''}`;
  
  const categoryBadge = student.classType === 'ØªÛŒÙˆØ´Ù†' 
    ? `<span class="category-badge category-tution">ØªÛŒÙˆØ´Ù†</span>`
    : `<span class="category-badge category-separa">Ø³Ù¾Ø§Ø±Û</span>`;
  
  card.innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
      <h3 style="margin:0;color:#1a5f7a;font-size:16px">
        ${student.name} (Ø±ÙˆÙ„: ${rollNo}) ${categoryBadge}
      </h3>
      <span class="status-badge ${student.status === 'active' ? 'active-badge' : 'kharaj-badge'}">
        ${student.status === 'active' ? 'ÙØ¹Ø§Ù„' : 'Ø®Ø§Ø±Ø¬'}
      </span>
    </div>
    <div class="student-info">
      <div class="info-item">
        <div class="info-label">ÙˆØ§Ù„Ø¯ Ú©Ø§ Ù†Ø§Ù…</div>
        <div class="info-value">${student.fatherName || '--'}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Ø¹Ù…Ø±</div>
        <div class="info-value">${student.age || '--'}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Ú©Ù„Ø§Ø³</div>
        <div class="info-value">${student.class || '--'}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Ú©Ù„Ø§Ø³ Ú©ÛŒ Ù‚Ø³Ù…</div>
        <div class="info-value">${student.classType || '--'}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Ø³Ù„Ø³Ù„Û Ù†Ù…Ø¨Ø±</div>
        <div class="info-value">${student.serialNo || '--'}</div>
      </div>
      <div class="info-item">
        <div class="info-label">ØªØ§Ø±ÛŒØ® Ø§Ù†Ø¯Ø±Ø§Ø¬</div>
        <div class="info-value">${student.admissionDate || '--'}</div>
      </div>
      ${student.status === 'kharaj' ? `
        <div class="info-item">
          <div class="info-label">ØªØ§Ø±ÛŒØ® Ø®Ø§Ø±Ø¬</div>
          <div class="info-value">${student.kharajDate || '--'}</div>
        </div>
        <div class="info-item">
          <div class="info-label">ÙˆØ¬Û Ø®Ø§Ø±Ø¬</div>
          <div class="info-value">${student.kharajReason || '--'}</div>
        </div>
        <div class="info-item">
          <div class="info-label">Ù…Ø¯Øª Ù‚ÛŒØ§Ù…</div>
          <div class="info-value">${student.duration || '--'} Ù…Ø§Û</div>
        </div>
      ` : ''}
    </div>
  `;
  
  container.appendChild(card);
}

// Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ Ù„Ø³Ù¹ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº
async function loadAllStudents() {
  try {
    const snapshot = await get(ref(db, 'students'));
    const activeList = document.getElementById('activeStudentsList');
    const outsideList = document.getElementById('outsideStudentsList');
    const tutionList = document.getElementById('tutionStudentsList');
    const separaList = document.getElementById('separaStudentsList');
    
    if (!snapshot.exists()) {
      activeList.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ ÙØ¹Ø§Ù„ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
      outsideList.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
      tutionList.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
      separaList.innerHTML = '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
      return;
    }
    
    const students = snapshot.val();
    let activeHtml = '';
    let outsideHtml = '';
    let tutionHtml = '';
    let separaHtml = '';
    
    for (const [rollNo, student] of Object.entries(students)) {
      const categoryBadge = student.classType === 'ØªÛŒÙˆØ´Ù†' 
        ? `<span class="category-badge category-tution" style="font-size:9px">ØªÛŒÙˆØ´Ù†</span>`
        : `<span class="category-badge category-separa" style="font-size:9px">Ø³Ù¾Ø§Ø±Û</span>`;
      
      const row = `
        <div style="padding:8px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center">
          <div>
            <strong>${rollNo}</strong> - ${student.name}
            <span style="font-size:10px;color:#666">(${student.class || '--'})</span>
          </div>
          <div>${categoryBadge}</div>
        </div>
      `;
      
      if (student.status === 'active') {
        activeHtml += row;
      } else {
        outsideHtml += row;
      }
      
      if (student.classType === 'ØªÛŒÙˆØ´Ù†') {
        tutionHtml += row;
      } else if (student.classType === 'Ø³Ù¾Ø§Ø±Û') {
        separaHtml += row;
      }
    }
    
    activeList.innerHTML = activeHtml || '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ ÙØ¹Ø§Ù„ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
    outsideList.innerHTML = outsideHtml || '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
    tutionList.innerHTML = tutionHtml || '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
    separaList.innerHTML = separaHtml || '<div style="text-align:center;padding:15px;color:#666">Ú©ÙˆØ¦ÛŒ Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù†ÛÛŒÚº</div>';
    
    updateStats();
  } catch (error) {
    console.error('Error loading students:', error);
  }
}

// Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø§Ù†Ø¯Ø±Ø§Ø¬ Ú©Ø±ÛŒÚº
window.addStudent = async () => {
  const rollNo = document.getElementById('rollNo').value.trim();
  const name = document.getElementById('name').value.trim();
  const admissionDate = document.getElementById('admissionDate').value;
  const classType = document.getElementById('classType').value;
  const className = document.getElementById('class').value.trim();
  
  if (!rollNo || !name || !admissionDate || !classType || !className) {
    alert('Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±ØŒ Ù†Ø§Ù…ØŒ ØªØ§Ø±ÛŒØ® Ø§Ù†Ø¯Ø±Ø§Ø¬ØŒ Ú©Ù„Ø§Ø³ Ú©ÛŒ Ù‚Ø³Ù… Ø§ÙˆØ± Ú©Ù„Ø§Ø³ Ø¶Ø±ÙˆØ±ÛŒ ÛÛ’');
    return;
  }
  
  // Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ ØªÙˆ Ù†ÛÛŒÚº
  const existingRef = ref(db, 'students/' + rollNo);
  const exists = await get(existingRef);
  if (exists.exists()) {
    alert('âŒ ÛŒÛ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ ÛÛ’!');
    return;
  }
  
  const studentData = {
    rollNo: rollNo,
    name: name,
    fatherName: document.getElementById('fatherName').value,
    age: document.getElementById('age').value,
    class: className,
    classType: classType,
    serialNo: document.getElementById('serialNo').value,
    admissionDate: admissionDate,
    status: 'active',
    createdAt: Date.now(),
    createdBy: auth.currentUser?.email || 'admin'
  };
  
  try {
    await set(ref(db, 'students/' + rollNo), studentData);
    alert('âœ… Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ø¯Ø±Ø¬ ÛÙˆÚ¯ÛŒØ§!');
    clearAdmissionForm();
    loadAllStudents();
  } catch (error) {
    alert('âŒ Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
  }
};

// Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø®Ø§Ø±Ø¬ Ú©Ø±ÛŒÚº
window.markKharaj = async () => {
  const rollNo = document.getElementById('kharajRoll').value.trim();
  const kharajDate = document.getElementById('kharajDate').value;
  const kharajReason = document.getElementById('kharajReason').value;
  
  if (!rollNo || !kharajDate || !kharajReason) {
    alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… ØªÙ…Ø§Ù… Ø¶Ø±ÙˆØ±ÛŒ ÙÛŒÙ„ÚˆØ² Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
    return;
  }
  
  try {
    const studentRef = ref(db, 'students/' + rollNo);
    const snapshot = await get(studentRef);
    
    if (!snapshot.exists()) {
      alert('âŒ ÛŒÛ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛ’!');
      return;
    }
    
    const student = snapshot.val();
    if (student.status === 'kharaj') {
      alert('âŒ ÛŒÛ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù¾ÛÙ„Û’ ÛÛŒ Ø®Ø§Ø±Ø¬ ÛÙˆÚ†Ú©Ø§ ÛÛ’!');
      return;
    }
    
    const kharajData = {
      status: 'kharaj',
      kharajDate: kharajDate,
      kharajReason: kharajReason,
      duration: document.getElementById('duration').value,
      kharajAt: Date.now()
    };
    
    await update(studentRef, kharajData);
    
    // Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ Ø¹Ù„ÛŒØ­Ø¯Û ÙÛØ±Ø³Øª Ù…ÛŒÚº Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº
    await set(ref(db, 'kharajStudents/' + rollNo), {
      ...student,
      ...kharajData
    });
    
    alert(`âœ… Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø®Ø§Ø±Ø¬ Ú©Ø±Ø¯ÛŒØ§ Ú¯ÛŒØ§!`);
    clearKharajForm();
    loadAllStudents();
  } catch (error) {
    alert('âŒ Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
  }
};

// Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… ÚˆÛŒÙ„ÛŒÙ¹ Ú©Ø±ÛŒÚº
window.deleteKharajStudent = async () => {
  const rollNo = document.getElementById('deleteRoll').value.trim();
  
  if (!rollNo) {
    alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
    return;
  }
  
  if (!confirm(`Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± "${rollNo}" Ú©Û’ ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ú©Ùˆ Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ ÛŒÛ Ø¹Ù…Ù„ ÙˆØ§Ù¾Ø³ Ù†ÛÛŒÚº ÛÙˆØ³Ú©ØªØ§Û”`)) {
    return;
  }
  
  try {
    // Ù¾ÛÙ„Û’ Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø®Ø§Ø±Ø¬ Ø´Ø¯Û ÛÛ’
    const studentRef = ref(db, 'students/' + rollNo);
    const snapshot = await get(studentRef);
    
    if (!snapshot.exists()) {
      alert('âŒ ÛŒÛ Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛ’!');
      return;
    }
    
    const student = snapshot.val();
    if (student.status !== 'kharaj') {
      alert('âŒ ØµØ±Ù Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ Ú©Ø§ ÚˆÛŒÙ¹Ø§ ÚˆÛŒÙ„ÛŒÙ¹ ÛÙˆØ³Ú©ØªØ§ ÛÛ’!');
      return;
    }
    
    // Ø§ØµÙ„ ÙÛØ±Ø³Øª Ø³Û’ ÚˆÛŒÙ„ÛŒÙ¹
    await remove(ref(db, 'students/' + rollNo));
    
    // Ø®Ø§Ø±Ø¬ Ø´Ø¯Û ÙÛØ±Ø³Øª Ø³Û’ ÚˆÛŒÙ„ÛŒÙ¹
    await remove(ref(db, 'kharajStudents/' + rollNo));
    
    alert(`âœ… Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ø­Ø°Ù Ú©Ø±Ø¯ÛŒØ§ Ú¯ÛŒØ§!`);
    document.getElementById('deleteRoll').value = '';
    loadAllStudents();
  } catch (error) {
    alert('âŒ ÚˆÛŒÙ„ÛŒÙ¹ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
  }
};

// Ø§ÛŒÚ©Ø³Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ
window.exportToExcel = async () => {
  try {
    const snapshot = await get(ref(db, 'students'));
    
    if (!snapshot.exists()) {
      alert('Ú©ÙˆØ¦ÛŒ ÚˆÛŒÙ¹Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛ’');
      return;
    }
    
    const students = snapshot.val();
    
    // ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª
    const allStudents = [];
    // ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª
    const activeStudents = [];
    // Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª
    const outsideStudents = [];
    // ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³ Ú©ÛŒ ÙÛØ±Ø³Øª
    const tutionStudents = [];
    // Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³ Ú©ÛŒ ÙÛØ±Ø³Øª
    const separaStudents = [];
    
    for (const [rollNo, student] of Object.entries(students)) {
      const row = {
        'Ø±ÙˆÙ„ Ù†Ù…Ø¨Ø±': rollNo,
        'Ù†Ø§Ù…': student.name || '',
        'ÙˆØ§Ù„Ø¯ Ú©Ø§ Ù†Ø§Ù…': student.fatherName || '',
        'Ø¹Ù…Ø±': student.age || '',
        'Ú©Ù„Ø§Ø³': student.class || '',
        'Ú©Ù„Ø§Ø³ Ú©ÛŒ Ù‚Ø³Ù…': student.classType || '',
        'Ø³Ù„Ø³Ù„Û Ù†Ù…Ø¨Ø±': student.serialNo || '',
        'ØªØ§Ø±ÛŒØ® Ø§Ù†Ø¯Ø±Ø§Ø¬': student.admissionDate || '',
        'Ø­Ø§Ù„Øª': student.status === 'active' ? 'ÙØ¹Ø§Ù„' : 'Ø®Ø§Ø±Ø¬',
        'ØªØ§Ø±ÛŒØ® Ø®Ø§Ø±Ø¬': student.kharajDate || '',
        'ÙˆØ¬Û Ø®Ø§Ø±Ø¬': student.kharajReason || '',
        'Ù…Ø¯Øª Ù‚ÛŒØ§Ù…': student.duration ? student.duration + ' Ù…Ø§Û' : '',
        'ØªØ§Ø±ÛŒØ® ØªØ®Ù„ÛŒÙ‚': new Date(student.createdAt || Date.now()).toLocaleDateString('ur-PK'),
        'Ø¯Ø±Ø¬ Ú©Ø±Ù†Û’ ÙˆØ§Ù„Ø§': student.createdBy || ''
      };
      
      allStudents.push(row);
      
      if (student.status === 'active') {
        activeStudents.push(row);
      } else {
        outsideStudents.push(row);
      }
      
      if (student.classType === 'ØªÛŒÙˆØ´Ù†') {
        tutionStudents.push(row);
      } else if (student.classType === 'Ø³Ù¾Ø§Ø±Û') {
        separaStudents.push(row);
      }
    }
    
    // Workbook ØªÛŒØ§Ø± Ú©Ø±ÛŒÚº
    const wb = XLSX.utils.book_new();
    
    // Ø´ÛŒÙ¹Ø³ Ø¨Ù†Ø§Ø¦ÛŒÚº
    if (allStudents.length > 0) {
      const allSheet = XLSX.utils.json_to_sheet(allStudents);
      XLSX.utils.book_append_sheet(wb, allSheet, "ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡");
    }
    
    if (activeStudents.length > 0) {
      const activeSheet = XLSX.utils.json_to_sheet(activeStudents);
      XLSX.utils.book_append_sheet(wb, activeSheet, "ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡");
    }
    
    if (outsideStudents.length > 0) {
      const outsideSheet = XLSX.utils.json_to_sheet(outsideStudents);
      XLSX.utils.book_append_sheet(wb, outsideSheet, "Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡");
    }
    
    if (tutionStudents.length > 0) {
      const tutionSheet = XLSX.utils.json_to_sheet(tutionStudents);
      XLSX.utils.book_append_sheet(wb, tutionSheet, "ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³");
    }
    
    if (separaStudents.length > 0) {
      const separaSheet = XLSX.utils.json_to_sheet(separaStudents);
      XLSX.utils.book_append_sheet(wb, separaSheet, "Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³");
    }
    
    // ÙØ§Ø¦Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº
    const fileName = `Ù…Ø¯Ø±Ø³Û_Ø·Ù„Ø¨Ø§Ø¡_${new Date().toISOString().split('T')[0]}.xlsx`;
    XLSX.writeFile(wb, fileName);
    
    alert('âœ… Ø§ÛŒÚ©Ø³Ù„ ÙØ§Ø¦Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ ÛÙˆÚ¯Ø¦ÛŒ! 5 Ø´ÛŒÙ¹Ø³ ÛÛŒÚº: 1) ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ 2) ÙØ¹Ø§Ù„ Ø·Ù„Ø¨Ø§Ø¡ 3) Ø®Ø§Ø±Ø¬ Ø´Ø¯Û Ø·Ù„Ø¨Ø§Ø¡ 4) ØªÛŒÙˆØ´Ù† Ú©Ù„Ø§Ø³ 5) Ø³Ù¾Ø§Ø±Û Ú©Ù„Ø§Ø³');
  } catch (error) {
    alert('âŒ Ø§ÛŒÚ©Ø³Ù„ ÚˆØ§Ø¤Ù†Ù„ÙˆÚˆ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
  }
};

// ÙØ§Ø±Ù… ØµØ§Ù Ú©Ø±ÛŒÚº
function clearAdmissionForm() {
  const fields = ['rollNo', 'name', 'fatherName', 'age', 'class', 'serialNo'];
  fields.forEach(id => {
    const element = document.getElementById(id);
    if (element) element.value = '';
  });
  document.getElementById('admissionDate').value = '';
  document.getElementById('classType').value = '';
}

function clearKharajForm() {
  const fields = ['kharajRoll', 'kharajDate', 'duration'];
  fields.forEach(id => {
    const element = document.getElementById(id);
    if (element) element.value = '';
  });
  document.getElementById('kharajReason').value = '';
}

// ØªØ§Ø±ÛŒØ® Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº
document.addEventListener('DOMContentLoaded', () => {
  const today = new Date().toISOString().split('T')[0];
  const admissionDate = document.getElementById('admissionDate');
  const kharajDate = document.getElementById('kharajDate');
  
  if (admissionDate) admissionDate.value = today;
  if (kharajDate) kharajDate.value = today;
  
  // Ø³Ø±Ú† Ø¨Ø§Ø± Ø³Û’ ÚˆÛŒÙ¹Ø§ ÛØ§Ø¦ÛŒÚˆ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø§ÛŒÙˆÙ†Ù¹
  document.getElementById('searchRoll').addEventListener('input', (e) => {
    if (!e.target.value.trim()) {
      document.getElementById('searchResults').classList.add('hidden');
    }
  });
  
  document.getElementById('searchName').addEventListener('input', (e) => {
    if (!e.target.value.trim()) {
      document.getElementById('searchResults').classList.add('hidden');
    }
  });
});
</script>
</body>
</html>